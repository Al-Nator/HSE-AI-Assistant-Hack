![image](https://github.com/user-attachments/assets/678e6e14-ae3e-4aa6-a968-a81a333674e9)

# AI Assistant Hack: Python ‚Äì –ö–æ–º–∞–Ω–¥–∞ MMG

## –û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏
–ù–µ–æ–±—Ö–æ–¥–∏–º–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –ø–æ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å —Å—Ç—É–¥–µ–Ω—Ç–∞–º, –∫–∞–∫ –ø–æ–ø—Ä–∞–≤–∏—Ç—å –∏—Ö Python –∫–æ–¥, —á—Ç–æ–±—ã –æ–Ω —Ä–∞–±–æ—Ç–∞–ª –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

–°—Ç—É–¥–µ–Ω—Ç—ã, –∏–∑—É—á–∞—é—â–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ Python, –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ —Å—Ç–∞–ª–∫–∏–≤–∞—é—Ç—Å—è —Å —Ç—Ä—É–¥–Ω–æ—Å—Ç—è–º–∏ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞–Ω–∏–π. –û—Å–æ–±–µ–Ω–Ω–æ —ç—Ç–æ –ø—Ä–æ—è–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –ø–æ—Å—ã–ª–∫–µ –∑–∞–¥–∞—á–∏ –≤ —Ç–µ—Å—Ç–∏—Ä—É—é—â—É—é —Å–∏—Å—Ç–µ–º—É - –æ—Ç–∫—Ä—ã—Ç—ã–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã, –∞ –≤–æ—Ç –∑–∞–∫—Ä—ã—Ç—ã–µ - –Ω–µ—Ç, –∏ —É–∑–Ω–∞—Ç—å –∏—Ö –Ω–∏–∫–∞–∫ –Ω–µ–ª—å–∑—è.

–ú—ã —Ö–æ—Ç–∏–º, —á—Ç–æ–±—ã –∞–ª–≥–æ—Ä–∏—Ç–º –∏–≥—Ä–∞–ª —Ä–æ–ª—å –ª–∏—á–Ω–æ–≥–æ –º–µ–Ω—Ç–æ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–π —Å–º–æ–∂–µ—Ç –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥ –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –Ω–µ —Ç–æ–ª—å–∫–æ —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫ (–∫–æ—Ç–æ—Ä—ã–µ —Å–º–æ–∂–µ—Ç –≤—ã—è–≤–∏—Ç—å –∏ —Å—Ä–µ–¥–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏, –∏ –ª–∏–Ω—Ç–µ—Ä, –∏ –¥—Ä.), –Ω–æ –∏ –ª–æ–≥–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏. –û–Ω –±—É–¥–µ—Ç –Ω–∞–ø—Ä–∞–≤–ª—è—Ç—å –º—ã—Å–ª—å –≤ –Ω—É–∂–Ω–æ–µ —Ä—É—Å–ª–æ, —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –ø–µ—Ä–µ–ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–∞–∫–æ–π-–ª–∏–±–æ –ª–æ–≥–∏–∫–∏ –≤ –∫–æ–¥–µ, –Ω–æ –Ω–µ –±—É–¥–µ—Ç –ø–∏—Å–∞—Ç—å –∫–æ–¥ –∑–∞ –Ω–µ–≥–æ.

## –°—Å—ã–ª–∫–∏
–õ–µ–Ω–¥–∏–Ω–≥: https://www.hse.ru/ai-assistant-hack-python \
–°—Ç–∞—Ç—å—è –æ —Ö–∞–∫–∞—Ç–æ–Ω–µ: https://www.hse.ru/news/978685929.html \
–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: https://github.com/werserk/hse-aiahp-baseline \
–¢–µ—Å—Ç–∏—Ä—É—é—â–∞—è —Å–∏—Å—Ç–µ–º–∞: https://dsworks.ru/champ/hse-2024-october

## –°–æ—Å—Ç–∞–≤
* **–î–µ–Ω–∏—Å –ú–∞–ª–∏–∫–æ–≤** ‚Äì –ö–∞–ø–∏—Ç–∞–Ω, DA
* **–ê—Ä—Ç—ë–º –¢–∞—Ä–∞—Ç–∏–Ω** ‚Äì DS
* **–î–∞–Ω–∏–∏–ª –ê–ª—å-–ù–∞—Ç–æ—Ä** ‚Äì DS
* **–ò–ª—å—è –û–±—É—Ö–æ–≤** ‚Äì DE
* **–ú–∞–∫—Å–∏–º –ß—É–¥–∞—Å–æ–≤** ‚Äì PM

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ö–∞–∫–∞—Ç–æ–Ω–∞
### üì¢ –ö–æ–º–∞–Ω–¥–∞ MMG –∑–∞–Ω—è–ª–∞ ü•à –º–µ—Å—Ç–æ –∏ –ø–æ–ª—É—á–∏–ª–∞ –ø—Ä–∏–∑ 200 —Ç.—Ä.
![–•–∞–∫–∞—Ç–æ–Ω (274)](https://github.com/user-attachments/assets/37cfcf6d-8286-4abc-8245-9e9a4fd63aba)
![IMG_20241020_181450](https://github.com/user-attachments/assets/a5be7836-f988-4c71-a68e-a287b5934c5a)

–ú–µ—Ç—Ä–∏–∫–∞ –Ω–∞ –ø–∞–±–ª–∏–∫–µ | –ú–µ—Ç—Ä–∏–∫–∞ –Ω–∞ –ø—Ä–∏–≤–∞—Ç–µ
---|---
<img width="655" alt="image_scr_1" src="https://github.com/user-attachments/assets/26da6c73-9004-47c4-856a-58416e4ae644"> | <img width="653" alt="image_scr_2" src="https://github.com/user-attachments/assets/ae01dca0-9a79-4a1d-9923-e3fdb8915126">

## –ó–∞–≥—Ä—É–∑–∫–∞
```nushell
git clone https://github.com/kekwak/HSE-AI-Assistant-Hack.git
cd HSE-AI-Assistant-Hack
```

## –ó–∞–ø—É—Å–∫ –≤ –∫–æ–Ω—Ç–µ–∏ÃÜ–Ω–µ—Ä–µ
–°–æ–±—Ä–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å–∞–º–æ–º—É:
```nushell
docker build -t kekwak/docker-app:latest .
docker run -v "$(pwd):/app" -v "$(pwd)/data:/app/data" -p 8000:8000 --gpus all --rm kekwak/docker-app:latest
```
–∏–ª–∏ —Å–∫–∞—á–∞—Ç—å –≥–æ—Ç–æ–≤—ã–π –æ–±—Ä–∞–∑:
```nushell
docker compose up --pull always
```
–∞ —Ç–∞–∫–∂–µ –∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –¥–æ–∫–µ—Ä—Ñ–∞–π–ª:
```nushell
docker build -f Dockerfile-conda -t kekwak/docker-app:latest-conda .
docker run -v "$(pwd):/app" -v "$(pwd)/data:/app/data" -p 8000:8000 --gpus all --rm kekwak/docker-app:latest-conda
```

## –ó–∞–ø—É—Å–∫ –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π —Å—Ä–µ–¥–µ
–í –ø—Ä–æ–µ–∫—Ç–µ –∏—Å—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–Ω–∞–∫–æ–Ω–¥–∞.
* –ü—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π —ç—Ç–∏–º —Å–ø–æ—Å–æ–±–æ–º –º–æ–≥—É—Ç –≤–æ–∑–Ω–∏–∫–Ω—É—Ç—å –ø—Ä–æ–±–ª–µ–º—ã.

```nushell
conda env create -f environment.yml
conda run -n unsloth_env pip install "unsloth @ git+https://github.com/unslothai/unsloth.git@79a2112ca4a775ce0b3cb75f5074136cb54ea6df"
conda run -n unsloth_env pip install --no-deps trl peft accelerate bitsandbytes
conda run -n unsloth_env pip install transformers==4.45.1 --force-reinstall
conda activate unsloth_env && python3 main.py
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```nushell
.
‚îú‚îÄ‚îÄ app
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ models   <---------------------- –ü–æ–¥–∫–ª—é—á–∞–µ–º—ã–µ –º–æ–¥–µ–ª–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ base.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ gemma.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ yandexgpt.py
‚îÇ   ‚îî‚îÄ‚îÄ utils    <---------------------- –£—Ç–∏–ª–∏—Ç—ã
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îú‚îÄ‚îÄ metric.py <----------------- –û–∑–Ω–∞–∫–æ–º—å—Ç–µ—Å—å —Å –º–µ—Ç—Ä–∏–∫–æ–π
‚îÇ       ‚îî‚îÄ‚îÄ submit.py <----------------- –ó–¥–µ—Å—å –≤—Å—ë –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–∞–±–º–∏—Ç–∞
‚îú‚îÄ‚îÄ data
‚îÇ   ‚îú‚îÄ‚îÄ complete
‚îÇ   ‚îú‚îÄ‚îÄ processed <--------------------- –ü–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, —Å–∞–±–º–∏—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ raw <--------------------------- –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îÇ       ‚îú‚îÄ‚îÄ submit_example.csv
‚îÇ       ‚îú‚îÄ‚îÄ test
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ solutions.xlsx
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ tasks.xlsx
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ tests.xlsx
‚îÇ       ‚îî‚îÄ‚îÄ train
‚îÇ           ‚îú‚îÄ‚îÄ solutions.xlsx
‚îÇ           ‚îú‚îÄ‚îÄ tasks.xlsx
‚îÇ           ‚îî‚îÄ‚îÄ tests.xlsx
‚îú‚îÄ‚îÄ docker-compose.yaml
‚îú‚îÄ‚îÄ Dockerfile <------------------------ –î–æ–∫–µ—Ä—Ñ–∞–π–ª –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
‚îú‚îÄ‚îÄ Dockerfile-conda
‚îú‚îÄ‚îÄ environment.yml
‚îú‚îÄ‚îÄ gemma-2-9b-0.7846-12 <-------------- –ú–æ–¥–µ–ª—å
‚îÇ   ‚îú‚îÄ‚îÄ adapter_config.json
‚îÇ   ‚îú‚îÄ‚îÄ adapter_model.safetensors
‚îÇ   ‚îú‚îÄ‚îÄ README.md
‚îÇ   ‚îú‚îÄ‚îÄ special_tokens_map.json
‚îÇ   ‚îú‚îÄ‚îÄ tokenizer_config.json
‚îÇ   ‚îú‚îÄ‚îÄ tokenizer.json
‚îÇ   ‚îî‚îÄ‚îÄ tokenizer.model
‚îú‚îÄ‚îÄ .gitattributes
‚îú‚îÄ‚îÄ .gitignore
‚îú‚îÄ‚îÄ main.py <--------------------------- [–í–ê–ñ–ù–û] –ò–º–µ–Ω–Ω–æ —ç—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –º—ã –±—É–¥–µ–º –∑–∞–ø—É—Å–∫–∞—Ç—å –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –≤–∞—à–∏—Ö —Ä–µ—à–µ–Ω–∏–π. –û–Ω –¥–æ–ª–∂–µ–Ω –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —Å–∞–±–º–∏—Ç.
‚îú‚îÄ‚îÄ notebooks
‚îÇ   ‚îî‚îÄ‚îÄ yandexgpt.ipynb
‚îÇ   ‚îî‚îÄ‚îÄ train-model.ipynb <------------- –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
‚îÇ   ‚îî‚îÄ‚îÄ analys.ipynb <------------------ –ê–Ω–∞–ª–∏–∑
‚îú‚îÄ‚îÄ README.md <------------------------- –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
‚îî‚îÄ‚îÄ tests
    ‚îú‚îÄ‚îÄ test_correctness.py <----------- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∞–±–º–∏—Ç –Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å
    ‚îî‚îÄ‚îÄ test_embedding_generation.py <-- –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ –∏ –ø–æ–¥—Å—á—ë—Ç –º–µ—Ç—Ä–∏–∫–∏
```
